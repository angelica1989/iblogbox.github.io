(function(l){"object"==typeof exports&&"object"==typeof module?l(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],l):l(CodeMirror)})(function(l){function A(h,l,n){h=h.getWrapperElement().appendChild(document.createElement("div"));h.className=n?"CodeMirror-dialog CodeMirror-dialog-bottom":"CodeMirror-dialog CodeMirror-dialog-top";"string"==typeof l?h.innerHTML=l:h.appendChild(l);return h}function N(h,l){h.state.currentNotificationClose&&h.state.currentNotificationClose();
h.state.currentNotificationClose=l}l.defineExtension("openDialog",function(h,r,n){function t(h){if("string"==typeof h)B.value=h;else if(!w&&(w=!0,z.parentNode.removeChild(z),O.focus(),n.onClose))n.onClose(z)}n||(n={});N(this,null);var z=A(this,h,n.bottom),w=!1,O=this,B=z.getElementsByTagName("input")[0];if(B){B.focus();n.value&&(B.value=n.value,!1!==n.selectValueOnOpen&&B.select());if(n.onInput)l.on(B,"input",function(h){n.onInput(h,B.value,t)});if(n.onKeyUp)l.on(B,"keyup",function(h){n.onKeyUp(h,
B.value,t)});l.on(B,"keydown",function(h){if(!(n&&n.onKeyDown&&n.onKeyDown(h,B.value,t))){if(27==h.keyCode||!1!==n.closeOnEnter&&13==h.keyCode)B.blur(),l.e_stop(h),t();13==h.keyCode&&r(B.value,h)}});if(!1!==n.closeOnBlur)l.on(B,"blur",t)}else if(h=z.getElementsByTagName("button")[0]){l.on(h,"click",function(){t();O.focus()});if(!1!==n.closeOnBlur)l.on(h,"blur",t);h.focus()}return t});l.defineExtension("openConfirm",function(h,r,n){function t(){w||(w=!0,z.parentNode.removeChild(z),O.focus())}N(this,
null);var z=A(this,h,n&&n.bottom);h=z.getElementsByTagName("button");var w=!1,O=this,B=1;h[0].focus();for(n=0;n<h.length;++n){var V=h[n];(function(h){l.on(V,"click",function(B){l.e_preventDefault(B);t();h&&h(O)})})(r[n]);l.on(V,"blur",function(){--B;setTimeout(function(){0>=B&&t()},200)});l.on(V,"focus",function(){++B})}});l.defineExtension("openNotification",function(h,r){function n(){z||(z=!0,clearTimeout(w),t.parentNode.removeChild(t))}N(this,n);var t=A(this,h,r&&r.bottom),z=!1,w,O=r&&"undefined"!==
typeof r.duration?r.duration:5E3;l.on(t,"click",function(h){l.e_preventDefault(h);n()});O&&(w=setTimeout(n,O));return n})});
(function(l){"object"==typeof exports&&"object"==typeof module?l(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],l):l(CodeMirror)})(function(l){function A(h,l,n,A){var v=h.getLineHandle(l.line),L=l.ch-1,v=0<=L&&z[v.text.charAt(L)]||z[v.text.charAt(++L)];if(!v)return null;var D=">"==v.charAt(1)?1:-1;if(n&&0<D!=(L==l.ch))return null;n=h.getTokenTypeAt(t(l.line,L+1));h=N(h,t(l.line,L+(0<D?1:0)),D,n||null,A);return null==h?null:{from:t(l.line,L),
to:h&&h.pos,match:h&&h.ch==v.charAt(0),forward:0<D}}function N(h,l,n,A,v){var L=v&&v.maxScanLineLength||1E4,D=v&&v.maxScanLines||1E3,F=[];v=v&&v.bracketRegex?v.bracketRegex:/[(){}[\]]/;for(var D=0<n?Math.min(l.line+D,h.lastLine()+1):Math.max(h.firstLine()-1,l.line-D),r=l.line;r!=D;r+=n){var w=h.getLine(r);if(w){var P=0<n?0:w.length-1,H=0<n?w.length:-1;if(!(w.length>L))for(r==l.line&&(P=l.ch-(0>n?1:0));P!=H;P+=n){var I=w.charAt(P);if(v.test(I)&&(void 0===A||h.getTokenTypeAt(t(r,P+1))==A))if(">"==z[I].charAt(1)==
0<n)F.push(I);else if(F.length)F.pop();else return{pos:t(r,P),ch:I}}}}return r-n==(0<n?h.lastLine():h.firstLine())?!1:null}function h(h,l,r){for(var w=h.state.matchBrackets.maxHighlightLineLength||1E3,v=[],z=h.listSelections(),D=0;D<z.length;D++){var F=z[D].empty()&&A(h,z[D].head,!1,r);if(F&&h.getLine(F.from.line).length<=w){var N=F.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";v.push(h.markText(F.from,t(F.from.line,F.from.ch+1),{className:N}));F.to&&h.getLine(F.to.line).length<=
w&&v.push(h.markText(F.to,t(F.to.line,F.to.ch+1),{className:N}))}}if(v.length)if(n&&h.state.focused&&h.focus(),r=function(){h.operation(function(){for(var h=0;h<v.length;h++)v[h].clear()})},l)setTimeout(r,800);else return r}function r(l){l.operation(function(){w&&(w(),w=null);w=h(l,!1,l.state.matchBrackets)})}var n=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||8>document.documentMode),t=l.Pos,z={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"},w=null;l.defineOption("matchBrackets",
!1,function(h,n,t){t&&t!=l.Init&&h.off("cursorActivity",r);n&&(h.state.matchBrackets="object"==typeof n?n:{},h.on("cursorActivity",r))});l.defineExtension("matchBrackets",function(){h(this,!0)});l.defineExtension("findMatchingBracket",function(h,l,n){return A(this,h,l,n)});l.defineExtension("scanForBracket",function(h,l,n,r){return N(this,h,l,n,r)})});
(function(l){"object"==typeof exports&&"object"==typeof module?l(require("../lib/codemirror"),require("../addon/search/searchcursor"),require("../addon/dialog/dialog"),require("../addon/edit/matchbrackets.js")):"function"==typeof define&&define.amd?define(["../lib/codemirror","../addon/search/searchcursor","../addon/dialog/dialog","../addon/edit/matchbrackets"],l):l(CodeMirror)})(function(l){var A=[{keys:"<Left>",type:"keyToKey",toKeys:"h"},{keys:"<Right>",type:"keyToKey",toKeys:"l"},{keys:"<Up>",
type:"keyToKey",toKeys:"k"},{keys:"<Down>",type:"keyToKey",toKeys:"j"},{keys:"<Space>",type:"keyToKey",toKeys:"l"},{keys:"<BS>",type:"keyToKey",toKeys:"h",context:"normal"},{keys:"<C-Space>",type:"keyToKey",toKeys:"W"},{keys:"<C-BS>",type:"keyToKey",toKeys:"B",context:"normal"},{keys:"<S-Space>",type:"keyToKey",toKeys:"w"},{keys:"<S-BS>",type:"keyToKey",toKeys:"b",context:"normal"},{keys:"<C-n>",type:"keyToKey",toKeys:"j"},{keys:"<C-p>",type:"keyToKey",toKeys:"k"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>"},
{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"s",type:"keyToKey",toKeys:"cl",context:"normal"},{keys:"s",type:"keyToKey",toKeys:"c",context:"visual"},{keys:"S",type:"keyToKey",toKeys:"cc",context:"normal"},{keys:"S",type:"keyToKey",toKeys:"VdO",context:"visual"},{keys:"<Home>",type:"keyToKey",toKeys:"0"},{keys:"<End>",type:"keyToKey",toKeys:"$"},{keys:"<PageUp>",type:"keyToKey",
toKeys:"<C-b>"},{keys:"<PageDown>",type:"keyToKey",toKeys:"<C-f>"},{keys:"<CR>",type:"keyToKey",toKeys:"j^",context:"normal"},{keys:"H",type:"motion",motion:"moveToTopLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"M",type:"motion",motion:"moveToMiddleLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"L",type:"motion",motion:"moveToBottomLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"h",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!1}},{keys:"l",type:"motion",motion:"moveByCharacters",
motionArgs:{forward:!0}},{keys:"j",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,linewise:!0}},{keys:"k",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,linewise:!0}},{keys:"gj",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!0}},{keys:"gk",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!1}},{keys:"w",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1}},{keys:"W",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1,
bigWord:!0}},{keys:"e",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,inclusive:!0}},{keys:"E",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"b",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1}},{keys:"B",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1,bigWord:!0}},{keys:"ge",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,inclusive:!0}},{keys:"gE",type:"motion",
motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"{",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!1,toJumplist:!0}},{keys:"}",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!0,toJumplist:!0}},{keys:"<C-f>",type:"motion",motion:"moveByPage",motionArgs:{forward:!0}},{keys:"<C-b>",type:"motion",motion:"moveByPage",motionArgs:{forward:!1}},{keys:"<C-d>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!0,explicitRepeat:!0}},{keys:"<C-u>",
type:"motion",motion:"moveByScroll",motionArgs:{forward:!1,explicitRepeat:!0}},{keys:"gg",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"G",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!0,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"0",type:"motion",motion:"moveToStartOfLine"},{keys:"^",type:"motion",motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"+",type:"motion",motion:"moveByLines",
motionArgs:{forward:!0,toFirstChar:!0}},{keys:"-",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,toFirstChar:!0}},{keys:"_",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0,repeatOffset:-1}},{keys:"$",type:"motion",motion:"moveToEol",motionArgs:{inclusive:!0}},{keys:"%",type:"motion",motion:"moveToMatchedSymbol",motionArgs:{inclusive:!0,toJumplist:!0}},{keys:"f<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"F<character>",
type:"motion",motion:"moveToCharacter",motionArgs:{forward:!1}},{keys:"t<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"T<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!1}},{keys:";",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!0}},{keys:",",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!1}},{keys:"'<character>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0,linewise:!0}},
{keys:"`<character>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:"]`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0}},{keys:"[`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1}},{keys:"]'",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0,linewise:!0}},{keys:"['",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1,linewise:!0}},{keys:"]p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0,matchIndent:!0}},{keys:"[p",type:"action",
action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0,matchIndent:!0}},{keys:"]<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!0,toJumplist:!0}},{keys:"[<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!1,toJumplist:!0}},{keys:"|",type:"motion",motion:"moveToColumn"},{keys:"o",type:"motion",motion:"moveToOtherHighlightedEnd",context:"visual"},{keys:"O",type:"motion",motion:"moveToOtherHighlightedEnd",motionArgs:{sameLine:!0},context:"visual"},{keys:"d",
type:"operator",operator:"delete"},{keys:"y",type:"operator",operator:"yank"},{keys:"c",type:"operator",operator:"change"},{keys:">",type:"operator",operator:"indent",operatorArgs:{indentRight:!0}},{keys:"<",type:"operator",operator:"indent",operatorArgs:{indentRight:!1}},{keys:"g~",type:"operator",operator:"changeCase"},{keys:"gu",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},isEdit:!0},{keys:"gU",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},isEdit:!0},{keys:"n",
type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:!0}},{keys:"N",type:"motion",motion:"findNext",motionArgs:{forward:!1,toJumplist:!0}},{keys:"x",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!0},operatorMotionArgs:{visualLine:!1}},{keys:"X",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!1},operatorMotionArgs:{visualLine:!0}},{keys:"D",type:"operatorMotion",operator:"delete",motion:"moveToEol",motionArgs:{inclusive:!0},
context:"normal"},{keys:"D",type:"operator",operator:"delete",operatorArgs:{linewise:!0},context:"visual"},{keys:"Y",type:"operatorMotion",operator:"yank",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"Y",type:"operator",operator:"yank",operatorArgs:{linewise:!0},context:"visual"},{keys:"C",type:"operatorMotion",operator:"change",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"C",type:"operator",operator:"change",operatorArgs:{linewise:!0},context:"visual"},
{keys:"~",type:"operatorMotion",operator:"changeCase",motion:"moveByCharacters",motionArgs:{forward:!0},operatorArgs:{shouldMoveCursor:!0},context:"normal"},{keys:"~",type:"operator",operator:"changeCase",context:"visual"},{keys:"<C-w>",type:"operatorMotion",operator:"delete",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1},context:"insert"},{keys:"<C-i>",type:"action",action:"jumpListWalk",actionArgs:{forward:!0}},{keys:"<C-o>",type:"action",action:"jumpListWalk",actionArgs:{forward:!1}},
{keys:"<C-e>",type:"action",action:"scroll",actionArgs:{forward:!0,linewise:!0}},{keys:"<C-y>",type:"action",action:"scroll",actionArgs:{forward:!1,linewise:!0}},{keys:"a",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"charAfter"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"eol"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"endOfSelectedArea"},context:"visual"},{keys:"i",
type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"inplace"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"firstNonBlank"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"startOfSelectedArea"},context:"visual"},{keys:"o",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!0},context:"normal"},{keys:"O",type:"action",action:"newLineAndEnterInsertMode",
isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!1},context:"normal"},{keys:"v",type:"action",action:"toggleVisualMode"},{keys:"V",type:"action",action:"toggleVisualMode",actionArgs:{linewise:!0}},{keys:"<C-v>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"<C-q>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"gv",type:"action",action:"reselectLastSelection"},{keys:"J",type:"action",action:"joinLines",isEdit:!0},{keys:"p",type:"action",action:"paste",
isEdit:!0,actionArgs:{after:!0,isEdit:!0}},{keys:"P",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0}},{keys:"r<character>",type:"action",action:"replace",isEdit:!0},{keys:"@<character>",type:"action",action:"replayMacro"},{keys:"q<character>",type:"action",action:"enterMacroRecordMode"},{keys:"R",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{replace:!0}},{keys:"u",type:"action",action:"undo",context:"normal"},{keys:"u",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},
context:"visual",isEdit:!0},{keys:"U",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},context:"visual",isEdit:!0},{keys:"<C-r>",type:"action",action:"redo"},{keys:"m<character>",type:"action",action:"setMark"},{keys:'"<character>',type:"action",action:"setRegister"},{keys:"zz",type:"action",action:"scrollToCursor",actionArgs:{position:"center"}},{keys:"z.",type:"action",action:"scrollToCursor",actionArgs:{position:"center"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"zt",type:"action",
action:"scrollToCursor",actionArgs:{position:"top"}},{keys:"z<CR>",type:"action",action:"scrollToCursor",actionArgs:{position:"top"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"z-",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"}},{keys:"zb",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:".",type:"action",action:"repeatLastEdit"},{keys:"<C-a>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!0,
backtrack:!1}},{keys:"<C-x>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!1,backtrack:!1}},{keys:"a<character>",type:"motion",motion:"textObjectManipulation"},{keys:"i<character>",type:"motion",motion:"textObjectManipulation",motionArgs:{textObjectInner:!0}},{keys:"/",type:"search",searchArgs:{forward:!0,querySrc:"prompt",toJumplist:!0}},{keys:"?",type:"search",searchArgs:{forward:!1,querySrc:"prompt",toJumplist:!0}},{keys:"*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",
wholeWordOnly:!0,toJumplist:!0}},{keys:"#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"g*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:"g#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:":",type:"ex"}],N=[{name:"colorscheme",shortName:"colo"},{name:"map"},{name:"imap",shortName:"im"},{name:"nmap",shortName:"nm"},{name:"vmap",shortName:"vm"},{name:"unmap"},{name:"write",
shortName:"w"},{name:"undo",shortName:"u"},{name:"redo",shortName:"red"},{name:"set",shortName:"se"},{name:"set",shortName:"se"},{name:"setlocal",shortName:"setl"},{name:"setglobal",shortName:"setg"},{name:"sort",shortName:"sor"},{name:"substitute",shortName:"s",possiblyAsync:!0},{name:"nohlsearch",shortName:"noh"},{name:"delmarks",shortName:"delm"},{name:"registers",shortName:"reg",excludeFromCommandHistory:!0},{name:"global",shortName:"g"}],h=l.Pos;l.Vim=function(){function r(a,b){this==l.keyMap.vim&&
l.rmClass(a.getWrapperElement(),"cm-fat-cursor");b&&b.attach==n||(a.setOption("disableInput",!1),a.off("cursorActivity",ya),l.off(a.getInputField(),"paste",w(a)),a.state.vim=null)}function n(a,b){this==l.keyMap.vim&&l.addClass(a.getWrapperElement(),"cm-fat-cursor");b&&b.attach==n||(a.setOption("disableInput",!0),a.setOption("showCursorWhenSelecting",!1),l.signal(a,"vim-mode-change",{mode:"normal"}),a.on("cursorActivity",ya),ha(a),l.on(a.getInputField(),"paste",w(a)))}function t(a,b){if(b){var c=z(a);
if(!c)return!1;var d=l.Vim.findKey(b,c);"function"==typeof d&&l.signal(b,"vim-keypress",c);return d}}function z(a){if("'"==a.charAt(0))return a.charAt(1);a=a.split(/-(?!$)/);var b=a[a.length-1];if(1==a.length&&1==a[0].length||2==a.length&&"Shift"==a[0]&&1==b.length)return!1;for(var c=!1,d=0;d<a.length;d++){var f=a[d];f in za?a[d]=za[f]:c=!0;f in Aa&&(a[d]=Aa[f])}if(!c)return!1;V(b)&&(a[a.length-1]=b.toLowerCase());return"<"+a.join("-")+">"}function w(a){var b=a.state.vim;b.onPasteFn||(b.onPasteFn=
function(){b.insertMode||(a.setCursor(J(a.getCursor(),0,1)),ia.enterInsertMode(a,{},b))});return b.onPasteFn}function O(a,b){for(var c=[],d=a;d<a+b;d++)c.push(String.fromCharCode(d));return c}function B(a,b){return b>=a.firstLine()&&b<=a.lastLine()}function V(a){return/^[A-Z]$/.test(a)}function pa(a,b){for(var c=0;c<b.length;c++)if(b[c]==a)return!0;return!1}function v(a,b,c,d,f){if(void 0===b&&!f)throw Error("defaultValue is required unless callback is provided");c||(c="string");W[a]={type:c,defaultValue:b,
callback:f};if(d)for(c=0;c<d.length;c++)W[d[c]]=W[a];b&&L(a,b)}function L(a,b,c,d){var f=W[a];d=d||{};d=d.scope;if(!f)throw Error("Unknown option: "+a);if("boolean"==f.type){if(b&&!0!==b)throw Error("Invalid argument: "+a+"="+b);!1!==b&&(b=!0)}f.callback?("local"!==d&&f.callback(b,void 0),"global"!==d&&c&&f.callback(b,c)):("local"!==d&&(f.value="boolean"==f.type?!!b:b),"global"!==d&&c&&(c.state.vim.options[a]={value:b}))}function D(a,b,c){var d=W[a];c=c||{};c=c.scope;if(!d)throw Error("Unknown option: "+
a);if(d.callback){a=b&&d.callback(void 0,b);if("global"!==c&&void 0!==a)return a;if("local"!==c)return d.callback()}else return a="global"!==c&&b&&b.state.vim.options[a],(a||"local"!==c&&d||{}).value}function F(){this.latestRegister=void 0;this.isRecording=this.isPlaying=!1;this.replaySearchQueries=[];this.onRecordingDone=void 0;this.lastInsertModeChanges=Ba()}function ha(a){a.state.vim||(a.state.vim={inputState:new P,lastEditInputState:void 0,lastEditActionCommand:void 0,lastHPos:-1,lastHSPos:-1,
lastMotion:null,marks:{},fakeCursor:null,insertMode:!1,insertModeRepeat:void 0,visualMode:!1,visualLine:!1,visualBlock:!1,lastSelection:null,lastPastedText:null,sel:{},options:{}});return a.state.vim}function xa(){q={searchQuery:null,searchIsReversed:!1,lastSubstituteReplacePart:void 0,jumpList:cb(),macroModeState:new F,lastChararacterSearch:{increment:0,forward:!0,selectedCharacter:""},registerController:new Ca({}),searchHistoryController:new qa({}),exCommandHistoryController:new qa({})};for(var a in W){var b=
W[a];b.value=b.defaultValue}}function P(){this.prefixRepeat=[];this.motionRepeat=[];this.motionArgs=this.motion=this.operatorArgs=this.operator=null;this.keyBuffer=[];this.registerName=null}function H(a,b){a.state.vim.inputState=new P;l.signal(a,"vim-command-done",b)}function I(a,b,c){this.clear();this.keyBuffer=[a||""];this.insertModeChanges=[];this.searchQueries=[];this.linewise=!!b;this.blockwise=!!c}function Ca(a){this.registers=a;this.unnamedRegister=a['"']=new I;a["."]=new I;a[":"]=new I;a["/"]=
new I}function qa(){this.historyBuffer=[];this.iterator;this.initialPrefix=null}function Da(a,b){for(var c=[],d=0;d<b;d++)c.push(a);return c}function K(a,b,c){var d=Math.min(Math.max(a.firstLine(),b.line),a.lastLine());a=G(a,d)-1;a=c?a+1:a;b=Math.min(Math.max(0,b.ch),a);return h(d,b)}function ja(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function J(a,b,c){"object"===typeof b&&(c=b.ch,b=b.line);return h(a.line+b,a.ch+c)}function db(a,b){return{line:b.line-a.line,ch:b.line-a.line}}
function Ea(a,b,c){return function(){for(var d=0;d<c;d++)b(a)}}function C(a){return h(a.line,a.ch)}function R(a,b){return a.ch==b.ch&&a.line==b.line}function E(a,b){return a.line<b.line||a.line==b.line&&a.ch<b.ch?!0:!1}function Q(a,b){2<arguments.length&&(b=Q.apply(void 0,Array.prototype.slice.call(arguments,1)));return E(a,b)?a:b}function aa(a,b){2<arguments.length&&(b=aa.apply(void 0,Array.prototype.slice.call(arguments,1)));return E(a,b)?b:a}function Fa(a,b,c){a=E(a,b);b=E(b,c);return a&&b}function G(a,
b){return a.getLine(b).length}function ra(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function eb(a,b,c){var d=G(a,b);c=Array(c-d+1).join(" ");a.setCursor(h(b,d));a.replaceRange(c,a.getCursor())}function Ga(a,b){var c=[],d=a.listSelections(),f=C(a.clipPos(b)),e=!R(b,f),g;a:{var m=a.getCursor("head");for(g=0;g<d.length;g++){var k=R(d[g].anchor,m),M=R(d[g].head,m);if(k||M)break a}g=-1}var m=R(d[g].head,d[g].anchor),k=d.length-1,y=k-g>g?k:0;g=d[y].anchor;var l=Math.min(g.line,f.line),k=Math.max(g.line,
f.line),M=g.ch,f=f.ch,d=d[y].head.ch-M,y=f-M;0<d&&0>=y?(M++,e||f--):0>d&&0<=y?(M--,m||f++):0>d&&-1==y&&(M--,f++);for(e=l;e<=k;e++)d={anchor:new h(e,M),head:new h(e,f)},c.push(d);a.setSelections(c);b.ch=f;g.ch=M;return g}function Ha(a,b,c){for(var d=[],f=0;f<c;f++){var e=J(b,f,0);d.push({anchor:e,head:e})}a.setSelections(d,0)}function fb(a,b){var c=b.lastSelection,d=function(){var b=a.getCursor(),d=a.getCursor(),g=c.visualBlock;if(g){for(var d=h(b.line+g.height,b.ch+g.width),g=[],m=b.line;m<d.line;m++){var k=
h(m,b.ch),M=h(m,d.ch);g.push({anchor:k,head:M})}a.setSelections(g)}else m=c.anchorMark.find(),k=c.headMark.find(),g=k.line-m.line,m=k.ch-m.ch,d={line:d.line+g,ch:g?d.ch:m+d.ch},c.visualLine&&(b=h(b.line,0),d=h(d.line,G(a,d.line))),a.setSelection(b,d);return[b,d]};return b.visualMode?function(){var b=a.listSelections(),c=b[0],b=b[b.length-1],c=E(c.anchor,c.head)?c.anchor:c.head,b=E(b.anchor,b.head)?b.head:b.anchor;return[c,b]}():d()}function Ia(a,b){var c=b.sel.anchor,d=b.sel.head;b.lastPastedText&&
(d=a.posFromIndex(a.indexFromPos(c)+b.lastPastedText.length),b.lastPastedText=null);b.lastSelection={anchorMark:a.setBookmark(c),headMark:a.setBookmark(d),anchor:C(c),head:C(d),visualMode:b.visualMode,visualLine:b.visualLine,visualBlock:b.visualBlock}}function ca(a,b,c){var d=a.state.vim;b=b||d.sel;c=c||d.visualLine?"line":d.visualBlock?"block":"char";b=sa(a,b,c);a.setSelections(b.ranges,b.primary);Ja(a)}function sa(a,b,c,d){var f=C(b.head),e=C(b.anchor);if("char"==c)return f=d||E(b.head,b.anchor)?
0:1,e=E(b.head,b.anchor)?1:0,f=J(b.head,0,f),e=J(b.anchor,0,e),{ranges:[{anchor:e,head:f}],primary:0};if("line"==c)return E(b.head,b.anchor)?(f.ch=0,e.ch=G(a,e.line)):(e.ch=0,b=a.lastLine(),f.line>b&&(f.line=b),f.ch=G(a,f.line)),{ranges:[{anchor:e,head:f}],primary:0};if("block"==c){b=Math.min(e.line,f.line);a=Math.min(e.ch,f.ch);c=Math.max(e.line,f.line);e=Math.max(e.ch,f.ch)+1;c=c-b+1;f=f.line==b?0:c-1;d=[];for(var g=0;g<c;g++)d.push({anchor:h(b+g,a),head:h(b+g,e)});return{ranges:d,primary:f}}}function S(a,
b){var c=a.state.vim;!1!==b&&a.setCursor(K(a,c.sel.head));Ia(a,c);c.visualMode=!1;c.visualLine=!1;c.visualBlock=!1;l.signal(a,"vim-mode-change",{mode:"normal"});c.fakeCursor&&c.fakeCursor.clear()}function T(a){if(!a)return 0;var b=a.search(/\S/);return-1==b?a.length:b}function ka(a,b,c,d,f){c=a.getCursor("head");1==a.getSelection().length&&(c=Q(c,a.getCursor("anchor")));a=a.getLine(c.line);var e=c.ch;for(f=f?la[0]:ta[0];!f(a.charAt(e));)if(e++,e>=a.length)return null;d?f=ta[0]:(f=la[0],f(a.charAt(e))||
(f=la[1]));for(d=e;f(a.charAt(d))&&d<a.length;)d++;for(;f(a.charAt(e))&&0<=e;)e--;e++;if(b){for(b=d;/\s/.test(a.charAt(d))&&d<a.length;)d++;if(b==d){for(b=e;/\s/.test(a.charAt(e-1))&&0<e;)e--;e||(e=b)}}return{start:h(c.line,e),end:h(c.line,d)}}function Ka(a,b){q.lastChararacterSearch.increment=a;q.lastChararacterSearch.forward=b.forward;q.lastChararacterSearch.selectedCharacter=b.selectedCharacter}function ua(a,b,c,d){for(var f=a.getCursor(),e=f.ch,g,m=0;m<b;m++){g=a.getLine(f.line);var k=d,M=void 0;
g=M=c?g.indexOf(k,e+1):g.lastIndexOf(k,e-1);if(-1==g)return null;e=g}return h(a.getCursor().line,g)}function X(a,b,c,d){pa(c,gb)&&(b.marks[c]&&b.marks[c].clear(),b.marks[c]=a.setBookmark(d))}function La(a,b,c,d,f){function e(b,c,d){return d?!a.getLine(b)!=!a.getLine(b+c):!!a.getLine(b)&&!a.getLine(b+c)}b=b.line;var g=a.firstLine(),m=a.lastLine(),k=b;if(d){for(;g<=k&&k<=m&&0<c;)e(k,d)&&c--,k+=d;return new h(k,0)}k=a.state.vim;k.visualLine&&e(b,1,!0)&&(k=k.sel.anchor,e(k.line,-1,!0)&&(f&&k.line==b||
(b+=1)));d=!a.getLine(b);for(k=b;k<=m&&c;k++)e(k,1,!0)&&(f&&!a.getLine(k)==d||c--);c=new h(k,0);k>m&&!d?d=!0:f=!1;for(k=b;k>g&&(f&&!a.getLine(k)!=d&&k!=b||!e(k,-1,!0));k--);return{start:new h(k,0),end:c}}function Ma(){}function Y(a){a=a.state.vim;return a.searchState_||(a.searchState_=new Ma)}function Na(a){var b=Oa(a)||[];if(!b.length)return[];var c=[];if(0===b[0]){for(var d=0;d<b.length;d++)"number"==typeof b[d]&&c.push(a.substring(b[d]+1,b[d+1]));return c}}function Oa(a){for(var b=!1,c=[],d=0;d<
a.length;d++){var f=a.charAt(d);b||"/"!=f||c.push(d);b=!b&&"\\"==f}return c}function x(a,b){a.openNotification?a.openNotification('<span style="color: red">'+b+"</span>",{bottom:!0,duration:5E3}):alert(b)}function ma(a,b){var c=(b.prefix||"")+" "+(b.desc||""),d;d=b.prefix;var f=b.desc,e="";d&&(e+='<span style="font-family: monospace">'+d+"</span>");e+='<input type="text"/> <span style="color: #888">';f&&(e=e+'<span style="color: #888">'+f,e+="</span>");d=e;f=b.onClose;a.openDialog?a.openDialog(d,
f,{bottom:!0,value:b.value,onKeyDown:b.onKeyDown,onKeyUp:b.onKeyUp,selectValueOnOpen:!1}):f(prompt(c,""))}function da(a,b,c,d){if(b){var f=Y(a),e;c=!!c;d=!!d;q.registerController.getRegister("/").setText(b);if(b instanceof RegExp)e=b;else{var g=Oa(b),m;g.length?(m=b.substring(0,g[0]),e=-1!=b.substring(g[0]).indexOf("i")):m=b;if(m){if(!D("pcre")){b=m;g=!1;m=[];for(var k=-1;k<b.length;k++){var h=b.charAt(k)||"",l=b.charAt(k+1)||"",n=l&&-1!="|(){".indexOf(l);g?("\\"===h&&n||m.push(h),g=!1):"\\"===h?
(g=!0,l&&-1!="}".indexOf(l)&&(n=!0),n&&"\\"!==l||m.push(h)):(m.push(h),n&&"\\"!==l&&m.push("\\"))}m=m.join("")}d&&(c=/^[^A-Z]*$/.test(m));e=new RegExp(m,c||e?"i":void 0)}else e=null}if(e){Pa(a,e);a:if(a=f.getQuery(),e instanceof RegExp&&a instanceof RegExp){c=["global","multiline","ignoreCase","source"];for(d=0;d<c.length;d++)if(b=c[d],e[b]!==a[b]){a=!1;break a}a=!0}else a=!1;if(a)return e;f.setQuery(e);return e}}}function hb(a){if("^"==a.source.charAt(0))var b=!0;return{token:function(c){if(b&&!c.sol())c.skipToEnd();
else{var d=c.match(a,!1);if(d){if(0==d[0].length)return c.next(),"searching";if(!c.sol()&&(c.backUp(1),!a.exec(c.next()+d[0])))return c.next(),null;c.match(a);return"searching"}for(;!c.eol()&&(c.next(),!c.match(a,!1)););}},query:a}}function Pa(a,b){var c=Y(a),d=c.getOverlay();d&&b==d.query||(d&&a.removeOverlay(d),d=hb(b),a.addOverlay(d),a.showMatchesOnScrollbar&&(c.getScrollbarAnnotate()&&c.getScrollbarAnnotate().clear(),c.setScrollbarAnnotate(a.showMatchesOnScrollbar(b))),c.setOverlay(d))}function Qa(a,
b,c,d){void 0===d&&(d=1);return a.operation(function(){for(var f=a.getCursor(),e=a.getSearchCursor(c,f),g=0;g<d;g++){var m=e.find(b);0==g&&m&&R(e.from(),f)&&(m=e.find(b));if(!m&&(e=a.getSearchCursor(c,b?h(a.lastLine()):h(a.firstLine(),0)),!e.find(b)))return}return e.from()})}function va(a){var b=Y(a);a.removeOverlay(Y(a).getOverlay());b.setOverlay(null);b.getScrollbarAnnotate()&&(b.getScrollbarAnnotate().clear(),b.setScrollbarAnnotate(null))}function ib(a,b,c){"number"!=typeof a&&(a=a.line);return b instanceof
Array?pa(a,b):c?a>=b&&a<=c:a==b}function wa(a){var b=a.getScrollInfo(),c=a.coordsChar({left:0,top:6+b.top},"local");a=a.coordsChar({left:0,top:b.clientHeight-10+b.top},"local");return{top:c.line,bottom:a.line}}function jb(a,b,c,d,f,e,g,m,k){function h(){a.operation(function(){for(;!u;)y(),n();p()})}function y(){var b=a.getRange(e.from(),e.to()).replace(g,m);e.replace(b)}function n(){for(;e.findNext()&&ib(e.from(),d,f);)if(c||!ba||e.from().line!=ba.line){a.scrollIntoView(e.from(),30);a.setSelection(e.from(),
e.to());ba=e.from();u=!1;return}u=!0}function p(b){b&&b();a.focus();ba&&(a.setCursor(ba),b=a.state.vim,b.exMode=!1,b.lastHPos=b.lastHSPos=ba.ch);k&&k()}function q(b,c,d){l.e_stop(b);switch(l.keyName(b)){case "Y":y();n();break;case "N":n();break;case "A":b=k;k=void 0;a.operation(h);k=b;break;case "L":y();case "Q":case "Esc":case "Ctrl-C":case "Ctrl-[":p(d)}u&&p(d);return!0}a.state.vim.exMode=!0;var u=!1,ba=e.from();n();u?x(a,"No matches for "+g.source):b?ma(a,{prefix:"replace with <strong>"+m+"</strong> (y/n/a/q/l)",
onKeyDown:q}):(h(),k&&k())}function ea(a){var b=a.state.vim,c=q.macroModeState,d=q.registerController.getRegister("."),f=c.isPlaying,e=c.lastInsertModeChanges,g=[];if(!f){for(var m=e.inVisualBlock?b.lastSelection.visualBlock.height:1,k=e.changes,g=[],h=0;h<k.length;)g.push(k[h]),k[h]instanceof na?h++:h+=m;e.changes=g;a.off("change",Ra);l.off(a.getInputField(),"keydown",Sa)}!f&&1<b.insertModeRepeat&&(Ta(a,b,b.insertModeRepeat-1,!0),b.lastEditInputState.repeatOverride=b.insertModeRepeat);delete b.insertModeRepeat;
b.insertMode=!1;a.setCursor(a.getCursor().line,a.getCursor().ch-1);a.setOption("keyMap","vim");a.setOption("disableInput",!0);a.toggleOverwrite(!1);d.setText(e.changes.join(""));l.signal(a,"vim-mode-change",{mode:"normal"});c.isRecording&&(c.isPlaying||(a=q.registerController.getRegister(c.latestRegister))&&a.pushInsertModeChanges&&a.pushInsertModeChanges(c.lastInsertModeChanges))}function Ua(a){A.unshift(a)}function Ra(a,b){var c=q.macroModeState,d=c.lastInsertModeChanges;if(!c.isPlaying)for(;b;){d.expectCursorActivityForChange=
!0;if("+input"==b.origin||"paste"==b.origin||void 0===b.origin)c=b.text.join("\n"),d.changes.push(c);b=b.next}}function ya(a){var b=a.state.vim;if(b.insertMode){var c=q.macroModeState;if(c.isPlaying)return;c=c.lastInsertModeChanges;c.expectCursorActivityForChange?c.expectCursorActivityForChange=!1:c.changes=[]}else if(!a.curOp.isVimOp){var c=a.getCursor("anchor"),d=a.getCursor("head");b.visualMode&&!a.somethingSelected()?S(a,!1):b.visualMode||b.insertMode||!a.somethingSelected()||(b.visualMode=!0,
b.visualLine=!1,l.signal(a,"vim-mode-change",{mode:"visual"}));if(b.visualMode){var f=E(d,c)?0:-1,e=E(d,c)?-1:0,d=J(d,0,f),c=J(c,0,e);b.sel={anchor:c,head:d};X(a,b,"<",Q(d,c));X(a,b,">",aa(d,c))}else b.insertMode||(b.lastHPos=a.getCursor().ch)}b.visualMode&&Ja(a)}function Ja(a){var b=a.state.vim,c=K(a,C(b.sel.head)),d=J(c,0,1);b.fakeCursor&&b.fakeCursor.clear();b.fakeCursor=a.markText(c,d,{className:"cm-animate-fat-cursor"})}function na(a){this.keyName=a}function Sa(a){function b(){c.changes.push(new na(d));
return!0}var c=q.macroModeState.lastInsertModeChanges,d=l.keyName(a);d&&(-1==d.indexOf("Delete")&&-1==d.indexOf("Backspace")||l.lookupKey(d,"vim-insert",b))}function Ta(a,b,c,d){function f(){m?Z.processAction(a,b,b.lastEditActionCommand):Z.evalInput(a,b)}function e(c){0<g.lastInsertModeChanges.changes.length&&(c=b.lastEditActionCommand?c:1,Va(a,g.lastInsertModeChanges.changes,c))}var g=q.macroModeState;g.isPlaying=!0;var m=!!b.lastEditActionCommand,k=b.inputState;b.inputState=b.lastEditInputState;
if(m&&b.lastEditActionCommand.interlaceInsertRepeat)for(var h=0;h<c;h++)f(),e(1);else d||f(),e(c);b.inputState=k;b.insertMode&&!d&&ea(a);g.isPlaying=!1}function Va(a,b,c){function d(b){if("string"==typeof b)l.commands[b](a);else b(a);return!0}var f=a.getCursor("head"),e=q.macroModeState.lastInsertModeChanges.inVisualBlock;e&&(c=a.state.vim.lastSelection,c=db(c.anchor,c.head),Ha(a,f,c.line+1),c=a.listSelections().length,a.setCursor(f));for(var g=0;g<c;g++){e&&a.setCursor(J(f,g,0));for(var m=0;m<b.length;m++){var k=
b[m];if(k instanceof na)l.lookupKey(k.keyName,"vim-insert",d);else{var h=a.getCursor();a.replaceRange(k,h,h)}}}e&&a.setCursor(J(f,0,1))}l.defineOption("vimMode",!1,function(a,b,c){b&&"vim"!=a.getOption("keyMap")?a.setOption("keyMap","vim"):!b&&c!=l.Init&&/^vim/.test(a.getOption("keyMap"))&&a.setOption("keyMap","default")});var za={Shift:"S",Ctrl:"C",Alt:"A",Cmd:"D",Mod:"A"},Aa={Enter:"CR",Backspace:"BS",Delete:"Del"},kb=/[\d]/,la=[l.isWordChar,function(a){return a&&!l.isWordChar(a)&&!/\s/.test(a)}],
ta=[function(a){return/\S/.test(a)}],oa=O(65,26),fa=O(97,26),Wa=O(48,10),gb=[].concat(oa,fa,Wa,["<",">"]),Xa=[].concat(oa,fa,Wa,["-",'"',".",":","/"]),W={};v("filetype",void 0,"string",["ft"],function(a,b){if(void 0!==b){if(void 0===a){var c=b.getOption("mode");return"null"==c?"":c}b.setOption("mode",""==a?"null":a)}});var cb=function(){var a=-1,b=0,c=0,d=Array(100);return{cachedCursor:void 0,add:function(f,e,g){function m(b){var c=++a%100,e=d[c];e&&e.clear();d[c]=f.setBookmark(b)}var k=d[a%100];
k?(k=k.find())&&!R(k,e)&&m(e):m(e);m(g);b=a;c=a-100+1;0>c&&(c=0)},move:function(f,e){a+=e;a>b?a=b:a<c&&(a=c);var g=d[(100+a)%100];if(g&&!g.find()){var m=0<e?1:-1,k,h=f.getCursor();do if(a+=m,(g=d[(100+a)%100])&&(k=g.find())&&!R(h,k))break;while(a<b&&a>c)}return g}}},Ba=function(a){return a?{changes:a.changes,expectCursorActivityForChange:a.expectCursorActivityForChange}:{changes:[],expectCursorActivityForChange:!1}};F.prototype={exitMacroRecordMode:function(){var a=q.macroModeState;if(a.onRecordingDone)a.onRecordingDone();
a.onRecordingDone=void 0;a.isRecording=!1},enterMacroRecordMode:function(a,b){var c=q.registerController.getRegister(b);c&&(c.clear(),this.latestRegister=b,a.openDialog&&(this.onRecordingDone=a.openDialog("(recording)["+b+"]",null,{bottom:!0})),this.isRecording=!0)}};var q,ga,oa={buildKeyMap:function(){},getRegisterController:function(){return q.registerController},resetVimGlobalState_:xa,getVimGlobalState_:function(){return q},maybeInitVimState_:ha,suppressErrorLogging:!1,InsertModeKey:na,map:function(a,
b,c){U.map(a,b,c)},unmap:function(a,b){U.unmap(a,b)},setOption:L,getOption:D,defineOption:v,defineEx:function(a,b,c){if(!b)b=a;else if(0!==a.indexOf(b))throw Error('(Vim.defineEx) "'+b+'" is not a prefix of "'+a+'", command not registered');Ya[a]=c;U.commandMap_[b]={name:a,shortName:b,type:"api"}},handleKey:function(a,b,c){a=this.findKey(a,b,c);if("function"===typeof a)return a()},findKey:function(a,b,c){function d(){if("<Esc>"==b)return H(a),g.visualMode?S(a):g.insertMode&&ea(a),!0}function f(){if(d())return!0;
for(var c=g.inputState.keyBuffer+=b,e=1==b.length,f=Z.matchCommand(c,A,g.inputState,"insert");1<c.length&&"full"!=f.type;){var c=g.inputState.keyBuffer=c.slice(1),m=Z.matchCommand(c,A,g.inputState,"insert");"none"!=m.type&&(f=m)}if("none"==f.type)return H(a),!1;if("partial"==f.type)return ga&&window.clearTimeout(ga),ga=window.setTimeout(function(){g.insertMode&&g.inputState.keyBuffer&&H(a)},D("insertModeEscKeysTimeout")),!e;ga&&window.clearTimeout(ga);e&&(e=a.getCursor(),a.replaceRange("",J(e,0,-(c.length-
1)),e,"+input"));H(a);return f.command}function e(){var e;a:{var f=q.macroModeState;if(f.isRecording){if("q"==b){f.exitMacroRecordMode();H(a);e=!0;break a}"mapping"!=c&&(e=b,f.isPlaying||(f=q.registerController.getRegister(f.latestRegister))&&f.pushText(e))}e=void 0}if(e||d())return!0;e=g.inputState.keyBuffer+=b;if(/^[1-9]\d*$/.test(e))return!0;f=/^(\d*)(.*)$/.exec(e);if(!f)return H(a),!1;var m=Z.matchCommand(f[2]||f[1],A,g.inputState,g.visualMode?"visual":"normal");if("none"==m.type)return H(a),
!1;if("partial"==m.type)return!0;g.inputState.keyBuffer="";f=/^(\d*)(.*)$/.exec(e);f[1]&&"0"!=f[1]&&g.inputState.pushRepeatDigit(f[1]);return m.command}var g=ha(a),m;m=g.insertMode?f():e();return!1===m?void 0:!0===m?function(){}:function(){return a.operation(function(){a.curOp.isVimOp=!0;try{if("keyToKey"==m.type)for(var c=m.toKeys,d;c;)d=/<\w+-.+?>|<\w+>|./.exec(c),b=d[0],c=c.substring(d.index+b.length),l.Vim.handleKey(a,b,"mapping");else Z.processCommand(a,g,m)}catch(e){throw a.state.vim=void 0,
ha(a),l.Vim.suppressErrorLogging||console.log(e),e;}return!0})}},handleEx:function(a,b){U.processCommand(a,b)},defineMotion:function(a,b){$[a]=b},defineAction:function(a,b){ia[a]=b},defineOperator:function(a,b){Za[a]=b},mapCommand:function(a,b,c,d,f){a={keys:a,type:b};a[b]=c;a[b+"Args"]=d;for(var e in f)a[e]=f[e];Ua(a)},_mapCommand:Ua,defineRegister:function(a,b){var c=q.registerController.registers[a];if(!a||1!=a.length)throw Error("Register name must be 1 character");if(c[a])throw Error("Register already defined "+
a);c[a]=b;Xa.push(a)},exitVisualMode:S,exitInsertMode:ea};P.prototype.pushRepeatDigit=function(a){this.operator?this.motionRepeat=this.motionRepeat.concat(a):this.prefixRepeat=this.prefixRepeat.concat(a)};P.prototype.getRepeat=function(){var a=0;if(0<this.prefixRepeat.length||0<this.motionRepeat.length)a=1,0<this.prefixRepeat.length&&(a*=parseInt(this.prefixRepeat.join(""),10)),0<this.motionRepeat.length&&(a*=parseInt(this.motionRepeat.join(""),10));return a};I.prototype={setText:function(a,b,c){this.keyBuffer=
[a||""];this.linewise=!!b;this.blockwise=!!c},pushText:function(a,b){b&&(this.linewise||this.keyBuffer.push("\n"),this.linewise=!0);this.keyBuffer.push(a)},pushInsertModeChanges:function(a){this.insertModeChanges.push(Ba(a))},pushSearchQuery:function(a){this.searchQueries.push(a)},clear:function(){this.keyBuffer=[];this.insertModeChanges=[];this.searchQueries=[];this.linewise=!1},toString:function(){return this.keyBuffer.join("")}};Ca.prototype={pushText:function(a,b,c,d,f){d&&"\n"==c.charAt(0)&&
(c=c.slice(1)+"\n");d&&"\n"!==c.charAt(c.length-1)&&(c+="\n");var e=this.isValidRegister(a)?this.getRegister(a):null;if(e)V(a)?e.pushText(c,d):e.setText(c,d,f),this.unnamedRegister.setText(e.toString(),d);else{switch(b){case "yank":this.registers["0"]=new I(c,d,f);break;case "delete":case "change":-1==c.indexOf("\n")?this.registers["-"]=new I(c,d):(this.shiftNumericRegisters_(),this.registers["1"]=new I(c,d))}this.unnamedRegister.setText(c,d,f)}},getRegister:function(a){if(!this.isValidRegister(a))return this.unnamedRegister;
a=a.toLowerCase();this.registers[a]||(this.registers[a]=new I);return this.registers[a]},isValidRegister:function(a){return a&&pa(a,Xa)},shiftNumericRegisters_:function(){for(var a=9;2<=a;a--)this.registers[a]=this.getRegister(""+(a-1))}};qa.prototype={nextMatch:function(a,b){var c=this.historyBuffer,d=b?-1:1;null===this.initialPrefix&&(this.initialPrefix=a);for(var f=this.iterator+d;b?0<=f:f<c.length;f+=d)for(var e=c[f],g=0;g<=e.length;g++)if(this.initialPrefix==e.substring(0,g))return this.iterator=
f,e;if(f>=c.length)return this.iterator=c.length,this.initialPrefix;if(0>f)return a},pushInput:function(a){var b=this.historyBuffer.indexOf(a);-1<b&&this.historyBuffer.splice(b,1);a.length&&this.historyBuffer.push(a)},reset:function(){this.initialPrefix=null;this.iterator=this.historyBuffer.length}};var Z={matchCommand:function(a,b,c,d){var f,e,g=[];f=[];for(var m=0;m<b.length;m++){var k=b[m],h;if(h=!("insert"==d&&"insert"!=k.context||k.context&&k.context!=d||c.operator&&"action"==k.type)){e=a;var l=
k.keys;if("<character>"==l.slice(-11)){h=l.length-11;var n=e.slice(0,h),l=l.slice(0,h);e=n==l&&e.length>h?"full":0==l.indexOf(n)?"partial":!1}else e=e==l?"full":0==l.indexOf(e)?"partial":!1;h=e}h&&("partial"==e&&g.push(k),"full"==e&&f.push(k))}b=g.length&&g;f=f.length&&f;if(!f&&!b)return{type:"none"};if(!f&&b)return{type:"partial"};var p;for(b=0;b<f.length;b++)d=f[b],p||(p=d);if("<character>"==p.keys.slice(-11)){a=(f=/^.*(<[\w\-]+>)$/.exec(a))?f[1]:a.slice(-1);if(1<a.length)switch(a){case "<CR>":a=
"\n";break;case "<Space>":a=" "}c.selectedCharacter=a}return{type:"full",command:p}},processCommand:function(a,b,c){b.inputState.repeatOverride=c.repeatOverride;switch(c.type){case "motion":this.processMotion(a,b,c);break;case "operator":this.processOperator(a,b,c);break;case "operatorMotion":this.processOperatorMotion(a,b,c);break;case "action":this.processAction(a,b,c);break;case "search":this.processSearch(a,b,c);break;case "ex":case "keyToEx":this.processEx(a,b,c)}},processMotion:function(a,b,
c){b.inputState.motion=c.motion;b.inputState.motionArgs=ja(c.motionArgs);this.evalInput(a,b)},processOperator:function(a,b,c){var d=b.inputState;if(d.operator){if(d.operator==c.operator){d.motion="expandToLine";d.motionArgs={linewise:!0};this.evalInput(a,b);return}H(a)}d.operator=c.operator;d.operatorArgs=ja(c.operatorArgs);b.visualMode&&this.evalInput(a,b)},processOperatorMotion:function(a,b,c){var d=b.visualMode,f=ja(c.operatorMotionArgs);f&&d&&f.visualLine&&(b.visualLine=!0);this.processOperator(a,
b,c);d||this.processMotion(a,b,c)},processAction:function(a,b,c){var d=b.inputState,f=d.getRepeat(),e=!!f,g=ja(c.actionArgs)||{};d.selectedCharacter&&(g.selectedCharacter=d.selectedCharacter);c.operator&&this.processOperator(a,b,c);c.motion&&this.processMotion(a,b,c);(c.motion||c.operator)&&this.evalInput(a,b);g.repeat=f||1;g.repeatIsExplicit=e;g.registerName=d.registerName;H(a);b.lastMotion=null;c.isEdit&&this.recordLastEdit(b,d,c);ia[c.action](a,g,b)},processSearch:function(a,b,c){function d(d,
e,f){q.searchHistoryController.pushInput(d);q.searchHistoryController.reset();try{da(a,d,e,f)}catch(g){x(a,"Invalid regex: "+d);H(a);return}Z.processMotion(a,b,{type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:c.searchArgs.toJumplist}})}function f(b){a.scrollTo(n.left,n.top);d(b,!0,!0);var c=q.macroModeState;c.isRecording&&(c.isPlaying||(c=q.registerController.getRegister(c.latestRegister))&&c.pushSearchQuery&&c.pushSearchQuery(b))}function e(b,c,d){b=l.keyName(b);"Up"==b||"Down"==
b?(c=q.searchHistoryController.nextMatch(c,"Up"==b?!0:!1)||"",d(c)):"Left"!=b&&"Right"!=b&&"Ctrl"!=b&&"Alt"!=b&&"Shift"!=b&&q.searchHistoryController.reset();var e;try{e=da(a,c,!0,!0)}catch(f){}e?a.scrollIntoView(Qa(a,!m,e),30):(va(a),a.scrollTo(n.left,n.top))}function g(b,c,d){var e=l.keyName(b);"Esc"==e||"Ctrl-C"==e||"Ctrl-["==e||"Backspace"==e&&""==c?(q.searchHistoryController.pushInput(c),q.searchHistoryController.reset(),da(a,y),va(a),a.scrollTo(n.left,n.top),l.e_stop(b),H(a),d(),a.focus()):
"Ctrl-U"==e&&(l.e_stop(b),d(""))}if(a.getSearchCursor){var m=c.searchArgs.forward,k=c.searchArgs.wholeWordOnly;Y(a).setReversed(!m);var h=m?"/":"?",y=Y(a).getQuery(),n=a.getScrollInfo();switch(c.searchArgs.querySrc){case "prompt":k=q.macroModeState;k.isPlaying?(h=k.replaySearchQueries.shift(),d(h,!0,!1)):ma(a,{onClose:f,prefix:h,desc:lb,onKeyUp:e,onKeyDown:g});break;case "wordUnderCursor":var p=ka(a,!1,!0,!1,!0),s=!0;p||(p=ka(a,!1,!0,!1,!1),s=!1);if(!p)break;h=a.getLine(p.start.line).substring(p.start.ch,
p.end.ch);h=s&&k?"\\b"+h+"\\b":h.replace(/([.?*+$\[\]\/\\(){}|\-])/g,"\\$1");q.jumpList.cachedCursor=a.getCursor();a.setCursor(p.start);d(h,!0,!1)}}},processEx:function(a,b,c){function d(b){q.exCommandHistoryController.pushInput(b);q.exCommandHistoryController.reset();U.processCommand(a,b)}function f(b,c,d){var f=l.keyName(b);if("Esc"==f||"Ctrl-C"==f||"Ctrl-["==f||"Backspace"==f&&""==c)q.exCommandHistoryController.pushInput(c),q.exCommandHistoryController.reset(),l.e_stop(b),H(a),d(),a.focus();"Up"==
f||"Down"==f?(c=q.exCommandHistoryController.nextMatch(c,"Up"==f?!0:!1)||"",d(c)):"Ctrl-U"==f?(l.e_stop(b),d("")):"Left"!=f&&"Right"!=f&&"Ctrl"!=f&&"Alt"!=f&&"Shift"!=f&&q.exCommandHistoryController.reset()}"keyToEx"==c.type?U.processCommand(a,c.exArgs.input):b.visualMode?ma(a,{onClose:d,prefix:":",value:"'<,'>",onKeyDown:f}):ma(a,{onClose:d,prefix:":",onKeyDown:f})},evalInput:function(a,b){var c=b.inputState,d=c.motion,f=c.motionArgs||{},e=c.operator,g=c.operatorArgs||{},m=c.registerName,k=b.sel,
l=C(b.visualMode?K(a,k.head):a.getCursor("head")),y=C(b.visualMode?K(a,k.anchor):a.getCursor("anchor")),n=C(l),y=C(y),p,s,u;e&&this.recordLastEdit(b,c);u=void 0!==c.repeatOverride?c.repeatOverride:c.getRepeat();if(0<u&&f.explicitRepeat)f.repeatIsExplicit=!0;else if(f.noRepeat||!f.explicitRepeat&&0===u)u=1,f.repeatIsExplicit=!1;c.selectedCharacter&&(f.selectedCharacter=g.selectedCharacter=c.selectedCharacter);f.repeat=u;H(a);if(d){p=$[d](a,l,f,b);b.lastMotion=$[d];if(!p)return;f.toJumplist&&(d=q.jumpList,
(c=d.cachedCursor)?(R(c,p)||q.jumpList.add(a,c,p),delete d.cachedCursor):R(l,p)||q.jumpList.add(a,l,p));p instanceof Array&&(s=p[0],p=p[1]);p||(p=C(l));b.visualMode?(b.visualBlock&&Infinity===p.ch||(p=K(a,p,b.visualBlock)),s&&(s=K(a,s,!0)),s=s||y,k.anchor=s,k.head=p,ca(a),X(a,b,"<",E(s,p)?s:p),X(a,b,">",E(s,p)?p:s)):e||(p=K(a,p),a.setCursor(p.line,p.ch))}if(e){g.lastSel?(s=y,k=g.lastSel,p=Math.abs(k.head.line-k.anchor.line),l=Math.abs(k.head.ch-k.anchor.ch),p=k.visualLine?h(y.line+p,y.ch):k.visualBlock?
h(y.line+p,y.ch+l):k.head.line==k.anchor.line?h(y.line,y.ch+l):h(y.line+p,y.ch),b.visualMode=!0,b.visualLine=k.visualLine,b.visualBlock=k.visualBlock,k=b.sel={anchor:s,head:p},ca(a)):b.visualMode&&(g.lastSel={anchor:C(k.anchor),head:C(k.head),visualBlock:b.visualBlock,visualLine:b.visualLine});if(b.visualMode){if(s=Q(k.head,k.anchor),k=aa(k.head,k.anchor),n=b.visualLine||g.linewise,f=b.visualBlock?"block":n?"line":"char",s=sa(a,{anchor:s,head:k},f),n)if(k=s.ranges,"block"==f)for(f=0;f<k.length;f++)k[f].head.ch=
G(a,k[f].head.line);else"line"==f&&(k[0].head=h(k[0].head.line+1,0))}else{s=C(s||y);k=C(p||n);E(k,s)&&(n=s,s=k,k=n);if(n=f.linewise||g.linewise)l=k,s.ch=0,l.ch=0,l.line++;else if(f.forward&&(l=k,d=a.getRange(s,l),/\n\s*$/.test(d))){d=d.split("\n");d.pop();for(c=d.pop();0<d.length&&c&&/^\s*$/.test(c);c=d.pop())l.line--,l.ch=0;c?(l.line--,l.ch=G(a,l.line)):l.ch=0}s=sa(a,{anchor:s,head:k},"char",!f.inclusive||n)}a.setSelections(s.ranges,s.primary);b.lastMotion=null;g.repeat=u;g.registerName=m;g.linewise=
n;e=Za[e](a,g,s.ranges,y,p);b.visualMode&&S(a,null!=e);e&&a.setCursor(e)}},recordLastEdit:function(a,b,c){var d=q.macroModeState;d.isPlaying||(a.lastEditInputState=b,a.lastEditActionCommand=c,d.lastInsertModeChanges.changes=[],d.lastInsertModeChanges.expectCursorActivityForChange=!1)}},$={moveToTopLine:function(a,b,c){b=wa(a).top+c.repeat-1;return h(b,T(a.getLine(b)))},moveToMiddleLine:function(a){var b=wa(a),b=Math.floor(.5*(b.top+b.bottom));return h(b,T(a.getLine(b)))},moveToBottomLine:function(a,
b,c){b=wa(a).bottom-c.repeat+1;return h(b,T(a.getLine(b)))},expandToLine:function(a,b,c){return h(b.line+c.repeat-1,Infinity)},findNext:function(a,b,c){b=Y(a);var d=b.getQuery();if(d){var f=!c.forward,f=b.isReversed()?!f:f;Pa(a,d);return Qa(a,f,d,c.repeat)}},goToMark:function(a,b,c,d){return(b=d.marks[c.selectedCharacter])?(b=b.find(),c.linewise?{line:b.line,ch:T(a.getLine(b.line))}:b):null},moveToOtherHighlightedEnd:function(a,b,c,d){return d.visualBlock&&c.sameLine?(b=d.sel,[K(a,h(b.anchor.line,
b.head.ch)),K(a,h(b.head.line,b.anchor.ch))]):[d.sel.head,d.sel.anchor]},jumpToMark:function(a,b,c,d){for(var f=0;f<c.repeat;f++){var e=b,g;for(g in d.marks)if(/^[a-z]$/.test(g)){var m=d.marks[g].find();if(c.forward?!E(m,e):!E(e,m))if(!c.linewise||m.line!=e.line){var k=R(e,b),l=c.forward?Fa(e,m,b):Fa(b,m,e);if(k||l)b=m}}}c.linewise&&(b=h(b.line,T(a.getLine(b.line))));return b},moveByCharacters:function(a,b,c){a=c.repeat;return h(b.line,c.forward?b.ch+a:b.ch-a)},moveByLines:function(a,b,c,d){var f=
b.ch;switch(d.lastMotion){case this.moveByLines:case this.moveByDisplayLines:case this.moveByScroll:case this.moveToColumn:case this.moveToEol:f=d.lastHPos;break;default:d.lastHPos=f}var e=c.repeat+(c.repeatOffset||0),e=c.forward?b.line+e:b.line-e,g=a.firstLine(),m=a.lastLine();if(e<g&&b.line==g)return this.moveToStartOfLine(a,b,c,d);if(e>m&&b.line==m)return this.moveToEol(a,b,c,d);c.toFirstChar&&(f=T(a.getLine(e)),d.lastHPos=f);d.lastHSPos=a.charCoords(h(e,f),"div").left;return h(e,f)},moveByDisplayLines:function(a,
b,c,d){switch(d.lastMotion){case this.moveByDisplayLines:case this.moveByScroll:case this.moveByLines:case this.moveToColumn:case this.moveToEol:break;default:d.lastHSPos=a.charCoords(b,"div").left}var f=c.repeat;b=a.findPosV(b,c.forward?f:-f,"line",d.lastHSPos);b.hitSide&&(c.forward?c={top:a.charCoords(b,"div").top+8,left:d.lastHSPos}:(c=a.charCoords(h(a.firstLine(),0),"div"),c.left=d.lastHSPos),b=a.coordsChar(c,"div"));d.lastHPos=b.ch;return b},moveByPage:function(a,b,c){var d=c.repeat;return a.findPosV(b,
c.forward?d:-d,"page")},moveByParagraph:function(a,b,c){return La(a,b,c.repeat,c.forward?1:-1)},moveByScroll:function(a,b,c,d){var f=a.getScrollInfo(),e=null;(e=c.repeat)||(e=f.clientHeight/(2*a.defaultTextHeight()));var g=a.charCoords(b,"local");c.repeat=e;e=$.moveByDisplayLines(a,b,c,d);if(!e)return null;b=a.charCoords(e,"local");a.scrollTo(null,f.top+b.top-g.top);return e},moveByWords:function(a,b,c){var d=b,f=c.repeat;b=!!c.forward;var e=!!c.wordEnd,g=!!c.bigWord;c=C(d);var m=[];(b&&!e||!b&&e)&&
f++;for(var k=!(b&&e),l=0;l<f;l++){var n;b:{n=a;var q=b,p=g,s=k,u=d.line,r=d.ch,t=n.getLine(u),v=q?1:-1,p=p?ta:la;if(s&&""==t){u+=v;t=n.getLine(u);if(!B(n,u)){n=null;break b}r=q?0:t.length}for(;;){if(s&&""==t){n={from:0,to:0,line:u};break b}for(var w=q=0<v?t.length:-1,x=q;r!=q;){for(var A=!1,z=0;z<p.length&&!A;++z)if(p[z](t.charAt(r))){for(w=r;r!=q&&p[z](t.charAt(r));)r+=v;x=r;A=w!=x;if(w!=d.ch||u!=d.line||x!=w+v){n={from:Math.min(w,x+1),to:Math.max(w,x),line:u};break b}}A||(r+=v)}u+=v;if(!B(n,u)){n=
null;break b}t=n.getLine(u);r=0<v?0:t.length}throw Error("The impossible happened.");}if(!n){g=G(a,a.lastLine());m.push(b?{line:a.lastLine(),from:g,to:g}:{line:0,from:0,to:0});break}m.push(n);d=h(n.line,b?n.to-1:n.from)}a=m.length!=f;f=m[0];g=m.pop();b&&!e?(a||f.from==c.ch&&f.line==c.line||(g=m.pop()),b=h(g.line,g.from)):b&&e?b=h(g.line,g.to-1):!b&&e?(a||f.to==c.ch&&f.line==c.line||(g=m.pop()),b=h(g.line,g.to)):b=h(g.line,g.from);return b},moveTillCharacter:function(a,b,c){a=ua(a,c.repeat,c.forward,
c.selectedCharacter);b=c.forward?-1:1;Ka(b,c);if(!a)return null;a.ch+=b;return a},moveToCharacter:function(a,b,c){var d=c.repeat;Ka(0,c);return ua(a,d,c.forward,c.selectedCharacter)||b},moveToSymbol:function(a,b,c){var d=c.repeat,f=c.forward,e=c.selectedCharacter;c=C(a.getCursor());var g=f?1:-1,m=f?a.lineCount():-1,k=c.ch,l=c.line,n=a.getLine(l),f={lineText:n,nextCh:n.charAt(k),lastCh:null,index:k,symb:e,reverseSymb:(f?{")":"(","}":"{"}:{"(":")","{":"}"})[e],forward:f,depth:0,curMoveThrough:!1};if(k=
mb[e]){e=$a[k].init;k=$a[k].isComplete;for(e&&e(f);l!==m&&d;)f.index+=g,f.nextCh=f.lineText.charAt(f.index),f.nextCh||(l+=g,f.lineText=a.getLine(l)||"",0<g?f.index=0:(e=f.lineText.length,f.index=0<e?e-1:0),f.nextCh=f.lineText.charAt(f.index)),k(f)&&(c.line=l,c.ch=f.index,d--);a=f.nextCh||f.curMoveThrough?h(l,f.index):c}else a=c;return a||b},moveToColumn:function(a,b,c,d){c=c.repeat;d.lastHPos=c-1;d.lastHSPos=a.charCoords(b,"div").left;b=a.getCursor().line;return K(a,h(b,c-1))},moveToEol:function(a,
b,c,d){d.lastHPos=Infinity;b=h(b.line+c.repeat-1,Infinity);c=a.clipPos(b);c.ch--;d.lastHSPos=a.charCoords(c,"div").left;return b},moveToFirstNonWhiteSpaceCharacter:function(a,b){return h(b.line,T(a.getLine(b.line)))},moveToMatchedSymbol:function(a,b){var c=b.line,d=b.ch,f=a.getLine(c),e;do if((e=f.charAt(d++))&&-1!="()[]{}".indexOf(e)){var g=a.getTokenTypeAt(h(c,d));if("string"!==g&&"comment"!==g)break}while(e);return e?a.findMatchingBracket(h(c,d)).to:b},moveToStartOfLine:function(a,b){return h(b.line,
0)},moveToLineOrEdgeOfDocument:function(a,b,c){b=c.forward?a.lastLine():a.firstLine();c.repeatIsExplicit&&(b=c.repeat-a.getOption("firstLineNumber"));return h(b,T(a.getLine(b)))},textObjectManipulation:function(a,b,c,d){var f={"'":!0,'"':!0},e=c.selectedCharacter;"b"==e?e="(":"B"==e&&(e="{");var g=!c.textObjectInner;if({"(":")",")":"(","{":"}","}":"{","[":"]","]":"["}[e]){var m,k;k={"(":/[()]/,")":/[()]/,"[":/[[\]]/,"]":/[[\]]/,"{":/[{}]/,"}":/[{}]/}[e];m={"(":"(",")":"(","[":"[","]":"[","{":"{",
"}":"{"}[e];c=a.getLine(b.line).charAt(b.ch)===m?1:0;m=a.scanForBracket(h(b.line,b.ch+c),-1,null,{bracketRegex:k});k=a.scanForBracket(h(b.line,b.ch+c),1,null,{bracketRegex:k});if(m&&k){m=m.pos;k=k.pos;if(m.line==k.line&&m.ch>k.ch||m.line>k.line)b=m,m=k,k=b;g?k.ch+=1:m.ch+=1;b={start:m,end:k}}else b={start:b,end:b}}else if(f[e]){c=e;b=C(b);d=a.getLine(b.line).split("");e=d.indexOf(c);b.ch<e?b.ch=e:e<b.ch&&d[b.ch]==c&&(k=b.ch,--b.ch);if(d[b.ch]!=c||k)for(e=b.ch;-1<e&&!m;e--)d[e]==c&&(m=e+1);else m=
b.ch+1;if(m&&!k)for(e=m,f=d.length;e<f&&!k;e++)d[e]==c&&(k=e);m&&k?(g&&(--m,++k),b={start:h(b.line,m),end:h(b.line,k)}):b={start:b,end:b}}else if("W"===e)b=ka(a,g,!0,!0);else if("w"===e)b=ka(a,g,!0,!1);else if("p"===e)if(b=La(a,b,c.repeat,0,g),c.linewise=!0,d.visualMode)d.visualLine||(d.visualLine=!0);else{if(g=d.inputState.operatorArgs)g.linewise=!0;b.end.line--}else return null;return a.state.vim.visualMode?(g=b.start,b=b.end,k=a.state.vim.sel,m=k.head,k=k.anchor,E(b,g)&&(c=b,b=g,g=c),E(m,k)?(m=
Q(g,m),k=aa(k,b)):(k=Q(g,k),m=aa(m,b),m=J(m,0,-1),-1==m.ch&&m.line!=a.firstLine()&&(m=h(m.line-1,G(a,m.line-1)))),[k,m]):[b.start,b.end]},repeatLastCharacterSearch:function(a,b,c){var d=q.lastChararacterSearch,f=c.repeat,e=c.forward===d.forward,g=(d.increment?1:0)*(e?-1:1);a.moveH(-g,"char");c.inclusive=e?!0:!1;c=ua(a,f,e,d.selectedCharacter);if(!c)return a.moveH(g,"char"),b;c.ch+=g;return c}},Za={change:function(a,b,c){var d,f,e=a.state.vim;q.macroModeState.lastInsertModeChanges.inVisualBlock=e.visualBlock;
if(e.visualMode)f=a.getSelection(),d=Da("",c.length),a.replaceSelections(d),d=Q(c[0].head,c[0].anchor);else{d=c[0].anchor;var g=c[0].head;f=a.getRange(d,g);e=e.lastEditInputState||{};if("moveByWords"==e.motion&&!/^\s*$/.test(f)){var m=/\s+$/.exec(f);m&&e.motionArgs&&e.motionArgs.forward&&(g=J(g,0,-m[0].length),f=f.slice(0,-m[0].length))}e=new h(d.line-1,Number.MAX_VALUE);m=a.firstLine()==a.lastLine();g.line>a.lastLine()&&b.linewise&&!m?a.replaceRange("",e,g):a.replaceRange("",d,g);b.linewise&&(m||
(a.setCursor(e),l.commands.newlineAndIndent(a)),d.ch=Number.MAX_VALUE)}q.registerController.pushText(b.registerName,"change",f,b.linewise,1<c.length);ia.enterInsertMode(a,{head:d},a.state.vim)},"delete":function(a,b,c){var d,f=a.state.vim;if(f.visualBlock){d=a.getSelection();var e=Da("",c.length);a.replaceSelections(e);c=c[0].anchor}else e=c[0].anchor,c=c[0].head,b.linewise&&c.line!=a.firstLine()&&e.line==a.lastLine()&&e.line==c.line-1&&(e.line==a.firstLine()?e.ch=0:e=h(e.line-1,G(a,e.line-1))),d=
a.getRange(e,c),a.replaceRange("",e,c),c=e,b.linewise&&(c=$.moveToFirstNonWhiteSpaceCharacter(a,e));q.registerController.pushText(b.registerName,"delete",d,b.linewise,f.visualBlock);return K(a,c)},indent:function(a,b,c){var d=a.state.vim,f=c[0].anchor.line,e=d.visualBlock?c[c.length-1].anchor.line:c[0].head.line,d=d.visualMode?b.repeat:1;for(b.linewise&&e--;f<=e;f++)for(var g=0;g<d;g++)a.indentLine(f,b.indentRight);return $.moveToFirstNonWhiteSpaceCharacter(a,c[0].anchor)},changeCase:function(a,b,
c,d,f){for(var e=a.getSelections(),g=[],h=b.toLower,k=0;k<e.length;k++){var l=e[k],n="";if(!0===h)n=l.toLowerCase();else if(!1===h)n=l.toUpperCase();else for(var q=0;q<l.length;q++)var p=l.charAt(q),n=n+(V(p)?p.toLowerCase():p.toUpperCase());g.push(n)}a.replaceSelections(g);return b.shouldMoveCursor?f:!a.state.vim.visualMode&&b.linewise&&c[0].anchor.line+1==c[0].head.line?$.moveToFirstNonWhiteSpaceCharacter(a,d):b.linewise?d:Q(c[0].anchor,c[0].head)},yank:function(a,b,c,d){var f=a.state.vim;a=a.getSelection();
c=f.visualMode?Q(f.sel.anchor,f.sel.head,c[0].head,c[0].anchor):d;q.registerController.pushText(b.registerName,"yank",a,b.linewise,f.visualBlock);return c}},ia={jumpListWalk:function(a,b,c){c.visualMode||(c=b.repeat,b=(b=(b=q.jumpList.move(a,b.forward?c:-c))?b.find():void 0)?b:a.getCursor(),a.setCursor(b))},scroll:function(a,b,c){if(!c.visualMode){var d=b.repeat||1;c=a.defaultTextHeight();var f=a.getScrollInfo().top,d=c*d,f=b.forward?f+d:f-d,d=C(a.getCursor()),e=a.charCoords(d,"local");b.forward?
f>e.top?(d.line+=(f-e.top)/c,d.line=Math.ceil(d.line),a.setCursor(d),e=a.charCoords(d,"local"),a.scrollTo(null,e.top)):a.scrollTo(null,f):(b=f+a.getScrollInfo().clientHeight,b<e.bottom?(d.line-=(e.bottom-b)/c,d.line=Math.floor(d.line),a.setCursor(d),e=a.charCoords(d,"local"),a.scrollTo(null,e.bottom-a.getScrollInfo().clientHeight)):a.scrollTo(null,f))}},scrollToCursor:function(a,b){var c=a.getCursor().line,d=a.charCoords(h(c,0),"local"),c=a.getScrollInfo().clientHeight,f=d.top,d=d.bottom-f;switch(b.position){case "center":f=
f-c/2+d;break;case "bottom":f=f-c+d}a.scrollTo(null,f)},replayMacro:function(a,b,c){var d=b.selectedCharacter;b=b.repeat;var f=q.macroModeState;"@"==d&&(d=f.latestRegister);for(;b--;){var e=a,g=c,h=f,k=d,n=q.registerController.getRegister(k);if(":"==k)n.keyBuffer[0]&&U.processCommand(e,n.keyBuffer[0]);else{var k=n.keyBuffer,y=0;h.isPlaying=!0;h.replaySearchQueries=n.searchQueries.slice(0);for(var r=0;r<k.length;r++)for(var p=k[r],s,u;p;)s=/<\w+-.+?>|<\w+>|./.exec(p),u=s[0],p=p.substring(s.index+u.length),
l.Vim.handleKey(e,u,"macro"),g.insertMode&&(s=n.insertModeChanges[y++].changes,q.macroModeState.lastInsertModeChanges.changes=s,Va(e,s,1),ea(e))}h.isPlaying=!1}},enterMacroRecordMode:function(a,b){q.macroModeState.enterMacroRecordMode(a,b.selectedCharacter)},enterInsertMode:function(a,b,c){if(!a.getOption("readOnly")){c.insertMode=!0;c.insertModeRepeat=b&&b.repeat||1;var d=b?b.insertAt:null,f=c.sel,e=b.head||a.getCursor("head"),g=a.listSelections().length;if("eol"==d)e=h(e.line,G(a,e.line));else if("charAfter"==
d)e=J(e,0,1);else if("firstNonBlank"==d)e=$.moveToFirstNonWhiteSpaceCharacter(a,e);else if("startOfSelectedArea"==d)c.visualBlock?(e=h(Math.min(f.head.line,f.anchor.line),Math.min(f.head.ch,f.anchor.ch)),g=Math.abs(f.head.line-f.anchor.line)+1):e=f.head.line<f.anchor.line?f.head:h(f.anchor.line,0);else if("endOfSelectedArea"==d)c.visualBlock?(e=h(Math.min(f.head.line,f.anchor.line),Math.max(f.head.ch+1,f.anchor.ch)),g=Math.abs(f.head.line-f.anchor.line)+1):e=f.head.line>=f.anchor.line?J(f.head,0,
1):h(f.anchor.line,0);else if("inplace"==d&&c.visualMode)return;a.setOption("keyMap","vim-insert");a.setOption("disableInput",!1);b&&b.replace?(a.toggleOverwrite(!0),a.setOption("keyMap","vim-replace"),l.signal(a,"vim-mode-change",{mode:"replace"})):(a.setOption("keyMap","vim-insert"),l.signal(a,"vim-mode-change",{mode:"insert"}));q.macroModeState.isPlaying||(a.on("change",Ra),l.on(a.getInputField(),"keydown",Sa));c.visualMode&&S(a);Ha(a,e,g)}},toggleVisualMode:function(a,b,c){var d=b.repeat,f=a.getCursor();
c.visualMode?c.visualLine^b.linewise||c.visualBlock^b.blockwise?(c.visualLine=!!b.linewise,c.visualBlock=!!b.blockwise,l.signal(a,"vim-mode-change",{mode:"visual",subMode:c.visualLine?"linewise":c.visualBlock?"blockwise":""}),ca(a)):S(a):(c.visualMode=!0,c.visualLine=!!b.linewise,c.visualBlock=!!b.blockwise,b=K(a,h(f.line,f.ch+d-1),!0),c.sel={anchor:f,head:b},l.signal(a,"vim-mode-change",{mode:"visual",subMode:c.visualLine?"linewise":c.visualBlock?"blockwise":""}),ca(a),X(a,c,"<",Q(f,b)),X(a,c,">",
aa(f,b)))},reselectLastSelection:function(a,b,c){b=c.lastSelection;c.visualMode&&Ia(a,c);if(b){var d=b.anchorMark.find(),f=b.headMark.find();d&&f&&(c.sel={anchor:d,head:f},c.visualMode=!0,c.visualLine=b.visualLine,c.visualBlock=b.visualBlock,ca(a),X(a,c,"<",Q(d,f)),X(a,c,">",aa(d,f)),l.signal(a,"vim-mode-change",{mode:"visual",subMode:c.visualLine?"linewise":c.visualBlock?"blockwise":""}))}},joinLines:function(a,b,c){var d;if(c.visualMode){b=a.getCursor("anchor");d=a.getCursor("head");if(E(d,b)){var f=
d;d=b;b=f}d.ch=G(a,d.line)-1}else d=Math.max(b.repeat,2),b=a.getCursor(),d=K(a,h(b.line+d-1,Infinity));for(var e=0,g=b.line;g<d.line;g++){var e=G(a,b.line),f=h(b.line+1,G(a,b.line+1)),m=a.getRange(b,f),m=m.replace(/\n\s*/g," ");a.replaceRange(m,b,f)}b=h(b.line,e);c.visualMode&&S(a,!1);a.setCursor(b)},newLineAndEnterInsertMode:function(a,b,c){c.insertMode=!0;var d=C(a.getCursor());d.line!==a.firstLine()||b.after?(d.line=b.after?d.line:d.line-1,d.ch=G(a,d.line),a.setCursor(d),(l.commands.newlineAndIndentContinueComment||
l.commands.newlineAndIndent)(a)):(a.replaceRange("\n",h(a.firstLine(),0)),a.setCursor(a.firstLine(),0));this.enterInsertMode(a,{repeat:b.repeat},c)},paste:function(a,b,c){var d=C(a.getCursor()),f=q.registerController.getRegister(b.registerName),e=f.toString();if(e){if(b.matchIndent)var g=a.getOption("tabSize"),m=function(a){var b=a.split("\t").length-1;a=a.split(" ").length-1;return b*g+1*a},k=a.getLine(a.getCursor().line),l=m(k.match(/^\s*/)[0]),k=e.replace(/\n$/,""),n=e!==k,r=m(e.match(/^\s*/)[0]),
e=k.replace(/^\s*/gm,function(b){b=l+(m(b)-r);return 0>b?"":a.getOption("indentWithTabs")?Array(Math.floor(b/g)+1).join("\t"):Array(b+1).join(" ")}),e=e+(n?"\n":"");1<b.repeat&&(e=Array(b.repeat+1).join(e));k=f.linewise;f=f.blockwise;if(k)c.visualMode?e=c.visualLine?e.slice(0,-1):"\n"+e.slice(0,e.length-1)+"\n":b.after?(e="\n"+e.slice(0,e.length-1),d.ch=G(a,d.line)):d.ch=0;else{if(f)for(e=e.split("\n"),n=0;n<e.length;n++)e[n]=""==e[n]?" ":e[n];d.ch+=b.after?1:0}var p;if(c.visualMode){c.lastPastedText=
e;b=fb(a,c);d=b[0];b=b[1];var n=a.getSelection(),s=a.listSelections(),s=Array(s.length).join("1").split("1");c.lastSelection&&(p=c.lastSelection.headMark.find());q.registerController.unnamedRegister.setText(n);f?(a.replaceSelections(s),b=h(d.line+e.length-1,d.ch),a.setCursor(d),Ga(a,b),a.replaceSelections(e),e=d):c.visualBlock?(a.replaceSelections(s),a.setCursor(d),a.replaceRange(e,d,d),e=d):(a.replaceRange(e,d,b),e=a.posFromIndex(a.indexFromPos(d)+e.length-1));p&&(c.lastSelection.headMark=a.setBookmark(p));
k&&(e.ch=0)}else if(f){a.setCursor(d);for(n=0;n<e.length;n++)p=d.line+n,p>a.lastLine()&&a.replaceRange("\n",h(p,0)),G(a,p)<d.ch&&eb(a,p,d.ch);a.setCursor(d);Ga(a,h(d.line+e.length-1,d.ch));a.replaceSelections(e);e=d}else a.replaceRange(e,d),k&&b.after?e=h(d.line+1,T(a.getLine(d.line+1))):k&&!b.after?e=h(d.line,T(a.getLine(d.line))):!k&&b.after?(p=a.indexFromPos(d),e=a.posFromIndex(p+e.length-1)):(p=a.indexFromPos(d),e=a.posFromIndex(p+e.length));c.visualMode&&S(a,!1);a.setCursor(e)}},undo:function(a,
b){a.operation(function(){Ea(a,l.commands.undo,b.repeat)();a.setCursor(a.getCursor("anchor"))})},redo:function(a,b){Ea(a,l.commands.redo,b.repeat)()},setRegister:function(a,b,c){c.inputState.registerName=b.selectedCharacter},setMark:function(a,b,c){X(a,c,b.selectedCharacter,a.getCursor())},replace:function(a,b,c){var d=b.selectedCharacter,f=a.getCursor(),e,g=a.listSelections();c.visualMode?(f=a.getCursor("start"),e=a.getCursor("end")):(e=a.getLine(f.line),b=f.ch+b.repeat,b>e.length&&(b=e.length),
e=h(f.line,b));"\n"==d?(c.visualMode||a.replaceRange("",f,e),(l.commands.newlineAndIndentContinueComment||l.commands.newlineAndIndent)(a)):(b=a.getRange(f,e),b=b.replace(/[^\n]/g,d),c.visualBlock?(f=Array(a.getOption("tabSize")+1).join(" "),b=a.getSelection(),b=b.replace(/\t/g,f).replace(/[^\n]/g,d).split("\n"),a.replaceSelections(b)):a.replaceRange(b,f,e),c.visualMode?(f=E(g[0].anchor,g[0].head)?g[0].anchor:g[0].head,a.setCursor(f),S(a,!1)):a.setCursor(J(e,0,-1)))},incrementNumberToken:function(a,
b){for(var c=a.getCursor(),d=a.getLine(c.line),f=/-?\d+/g,e,g,m,k;null!==(e=f.exec(d))&&!(k=e[0],g=e.index,m=g+k.length,c.ch<m););!b.backtrack&&m<=c.ch||!k||(d=b.increase?1:-1,d=parseInt(k)+d*b.repeat,k=h(c.line,g),m=h(c.line,m),d=d.toString(),a.replaceRange(d,k,m),a.setCursor(h(c.line,g+d.length-1)))},repeatLastEdit:function(a,b,c){if(c.lastEditInputState){var d=b.repeat;d&&b.repeatIsExplicit?c.lastEditInputState.repeatOverride=d:d=c.lastEditInputState.repeatOverride||d;Ta(a,c,d,!1)}},exitInsertMode:ea},
mb={"(":"bracket",")":"bracket","{":"bracket","}":"bracket","[":"section","]":"section","*":"comment","/":"comment",m:"method",M:"method","#":"preprocess"},$a={bracket:{isComplete:function(a){if(a.nextCh===a.symb){if(a.depth++,1<=a.depth)return!0}else a.nextCh===a.reverseSymb&&a.depth--;return!1}},section:{init:function(a){a.curMoveThrough=!0;a.symb=(a.forward?"]":"[")===a.symb?"{":"}"},isComplete:function(a){return 0===a.index&&a.nextCh===a.symb}},comment:{isComplete:function(a){var b="*"===a.lastCh&&
"/"===a.nextCh;a.lastCh=a.nextCh;return b}},method:{init:function(a){a.symb="m"===a.symb?"{":"}";a.reverseSymb="{"===a.symb?"}":"{"},isComplete:function(a){return a.nextCh===a.symb?!0:!1}},preprocess:{init:function(a){a.index=0},isComplete:function(a){if("#"===a.nextCh){var b=a.lineText.match(/#(\w+)/)[1];if("endif"===b){if(a.forward&&0===a.depth)return!0;a.depth++}else if("if"===b){if(!a.forward&&0===a.depth)return!0;a.depth--}if("else"===b&&0===a.depth)return!0}return!1}}};v("pcre",!0,"boolean");
Ma.prototype={getQuery:function(){return q.query},setQuery:function(a){q.query=a},getOverlay:function(){return this.searchOverlay},setOverlay:function(a){this.searchOverlay=a},isReversed:function(){return q.isReversed},setReversed:function(a){q.isReversed=a},getScrollbarAnnotate:function(){return this.annotate},setScrollbarAnnotate:function(a){this.annotate=a}};var ab={"\\n":"\n","\\r":"\r","\\t":"\t"},bb={"\\/":"/","\\\\":"\\","\\n":"\n","\\r":"\r","\\t":"\t"},lb="(Javascript regexp)",fa=function(){this.buildCommandMap_()};
fa.prototype={processCommand:function(a,b,c){var d=this;a.operation(function(){a.curOp.isVimOp=!0;d._processCommand(a,b,c)})},_processCommand:function(a,b,c){var d=a.state.vim,f=q.registerController.getRegister(":"),e=f.toString();d.visualMode&&S(a);d=new l.StringStream(b);f.setText(b);c=c||{};c.input=b;try{this.parseInput_(a,d,c)}catch(g){throw x(a,g),g;}var h,k;if(c.commandName){if(h=this.matchCommand_(c.commandName)){k=h.name;h.excludeFromCommandHistory&&f.setText(e);this.parseCommandArgs_(d,c,
h);if("exToKey"==h.type){for(b=0;b<h.toKeys.length;b++)l.Vim.handleKey(a,h.toKeys[b],"mapping");return}if("exToEx"==h.type){this.processCommand(a,h.toInput);return}}}else void 0!==c.line&&(k="move");if(k)try{Ya[k](a,c),h&&h.possiblyAsync||!c.callback||c.callback()}catch(n){throw x(a,n),n;}else x(a,'Not an editor command ":'+b+'"')},parseInput_:function(a,b,c){b.eatWhile(":");b.eat("%")?(c.line=a.firstLine(),c.lineEnd=a.lastLine()):(c.line=this.parseLineSpec_(a,b),void 0!==c.line&&b.eat(",")&&(c.lineEnd=
this.parseLineSpec_(a,b)));a=b.match(/^(\w+)/);c.commandName=a?a[1]:b.match(/.*/)[0];return c},parseLineSpec_:function(a,b){var c=b.match(/^(\d+)/);if(c)return parseInt(c[1],10)-1;switch(b.next()){case ".":return a.getCursor().line;case "$":return a.lastLine();case "'":if((c=a.state.vim.marks[b.next()])&&c.find())return c.find().line;throw Error("Mark not set");default:b.backUp(1)}},parseCommandArgs_:function(a,b,c){a.eol()||(b.argString=a.match(/.*/)[0],a=c.argDelimiter||/\s+/,a=ra(b.argString).split(a),
a.length&&a[0]&&(b.args=a))},matchCommand_:function(a){for(var b=a.length;0<b;b--){var c=a.substring(0,b);if(this.commandMap_[c]&&(c=this.commandMap_[c],0===c.name.indexOf(a)))return c}return null},buildCommandMap_:function(){this.commandMap_={};for(var a=0;a<N.length;a++){var b=N[a];this.commandMap_[b.shortName||b.name]=b}},map:function(a,b,c){if(":"!=a&&":"==a.charAt(0)){if(c)throw Error("Mode not supported for ex mappings");c=a.substring(1);":"!=b&&":"==b.charAt(0)?this.commandMap_[c]={name:c,
type:"exToEx",toInput:b.substring(1),user:!0}:this.commandMap_[c]={name:c,type:"exToKey",toKeys:b,user:!0}}else b=":"!=b&&":"==b.charAt(0)?{keys:a,type:"keyToEx",exArgs:{input:b.substring(1)},user:!0}:{keys:a,type:"keyToKey",toKeys:b,user:!0},c&&(b.context=c),A.unshift(b)},unmap:function(a,b){if(":"!=a&&":"==a.charAt(0)){if(b)throw Error("Mode not supported for ex mappings");var c=a.substring(1);if(this.commandMap_[c]&&this.commandMap_[c].user){delete this.commandMap_[c];return}}else for(c=0;c<A.length;c++)if(a==
A[c].keys&&A[c].context===b&&A[c].user){A.splice(c,1);return}throw Error("No such mapping.");}};var Ya={colorscheme:function(a,b){!b.args||1>b.args.length?x(a,a.getOption("theme")):a.setOption("theme",b.args[0])},map:function(a,b,c){var d=b.args;!d||2>d.length?a&&x(a,"Invalid mapping: "+b.input):U.map(d[0],d[1],c)},imap:function(a,b){this.map(a,b,"insert")},nmap:function(a,b){this.map(a,b,"normal")},vmap:function(a,b){this.map(a,b,"visual")},unmap:function(a,b,c){var d=b.args;!d||1>d.length?a&&x(a,
"No such mapping: "+b.input):U.unmap(d[0],c)},move:function(a,b){Z.processCommand(a,a.state.vim,{type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0},repeatOverride:b.line+1})},set:function(a,b){var c=b.args,d=b.setCfg||{};if(!c||1>c.length)a&&x(a,"Invalid mapping: "+b.input);else{var f=c[0].split("="),c=f[0],f=f[1],e=!1;if("?"==c.charAt(c.length-1)){if(f)throw Error("Trailing characters: "+b.argString);c=c.substring(0,c.length-1);e=!0}void 0===f&&
"no"==c.substring(0,2)&&(c=c.substring(2),f=!1);var g=W[c]&&"boolean"==W[c].type;g&&void 0==f&&(f=!0);!g&&void 0===f||e?(d=D(c,a,d),!0===d||!1===d?x(a," "+(d?"":"no")+c):x(a,"  "+c+"="+d)):L(c,f,a,d)}},setlocal:function(a,b){b.setCfg={scope:"local"};this.set(a,b)},setglobal:function(a,b){b.setCfg={scope:"global"};this.set(a,b)},registers:function(a,b){var c=b.args,d=q.registerController.registers,f="----------Registers----------<br><br>";if(c)for(var c=c.join(""),e=0;e<c.length;e++){if(h=c.charAt(e),
q.registerController.isValidRegister(h))var g=d[h]||new I,f=f+('"'+h+"    "+g.toString()+"<br>")}else for(var h in d)c=d[h].toString(),c.length&&(f+='"'+h+"    "+c+"<br>");x(a,f)},sort:function(a,b){function c(a,b){if(d){var c;c=a;a=b;b=c}f&&(a=a.toLowerCase(),b=b.toLowerCase());c=g&&q.exec(a);var e=g&&q.exec(b);if(!c)return a<b?-1:1;c=parseInt((c[1]+c[2]).toLowerCase(),r);e=parseInt((e[1]+e[2]).toLowerCase(),r);return c-e}var d,f,e,g,m=function(){if(b.argString){var a=new l.StringStream(b.argString);
a.eat("!")&&(d=!0);if(!a.eol()){if(!a.eatSpace())return"Invalid arguments";var c=a.match(/[a-z]+/);if(c){c=c[0];f=-1!=c.indexOf("i");e=-1!=c.indexOf("u");var h=-1!=c.indexOf("d")&&1,k=-1!=c.indexOf("x")&&1,c=-1!=c.indexOf("o")&&1;if(1<h+k+c)return"Invalid arguments";g=h&&"decimal"||k&&"hex"||c&&"octal"}if(a.match(/\/.*\//))return"patterns not supported"}}}();if(m)x(a,m+": "+b.argString);else{var m=b.line||a.firstLine(),k=b.lineEnd||b.line||a.lastLine();if(m!=k){var m=h(m,0),k=h(k,G(a,k)),n=a.getRange(m,
k).split("\n"),q="decimal"==g?/(-?)([\d]+)/:"hex"==g?/(-?)(?:0x)?([0-9a-f]+)/i:"octal"==g?/([0-7]+)/:null,r="decimal"==g?10:"hex"==g?16:"octal"==g?8:null,p=[],s=[];if(g)for(var u=0;u<n.length;u++)q.exec(n[u])?p.push(n[u]):s.push(n[u]);else s=n;p.sort(c);s.sort(c);n=d?p.concat(s):s.concat(p);if(e)for(var p=n,t,n=[],u=0;u<p.length;u++)p[u]!=t&&n.push(p[u]),t=p[u];a.replaceRange(n.join("\n"),m,k)}}},global:function(a,b){var c=b.argString;if(c){var d=void 0!==b.line?b.line:a.firstLine(),f=b.lineEnd||
b.line||a.lastLine(),e=Na(c),g;e.length&&(c=e[0],g=e.slice(1,e.length).join("/"));if(c)try{da(a,c,!0,!0)}catch(h){x(a,"Invalid regex: "+c);return}for(var e=Y(a).getQuery(),k=[],c="";d<=f;d++)e.test(a.getLine(d))&&(k.push(d+1),c+=a.getLine(d)+"<br>");if(g){var l=0,n=function(){l<k.length&&U.processCommand(a,k[l]+g,{callback:n});l++};n()}else x(a,c)}else x(a,"Regular Expression missing from global")},substitute:function(a,b){if(!a.getSearchCursor)throw Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.");
var c=b.argString,d=c?Na(c):[],f,e="",g,m,k=!1,n=!1;if(d.length){f=d[0];e=d[1];if(void 0!==e){if(D("pcre"))for(e=new l.StringStream(e),g=[];!e.eol();){for(;e.peek()&&"\\"!=e.peek();)g.push(e.next());var c=!1,r;for(r in bb)if(e.match(r,!0)){c=!0;g.push(bb[r]);break}c||g.push(e.next())}else for(r=!1,g=[],c=-1;c<e.length;c++){var t=e.charAt(c)||"",p=e.charAt(c+1)||"";ab[t+p]?(g.push(ab[t+p]),c++):r?(g.push(t),r=!1):"\\"===t?(r=!0,kb.test(p)||"$"===p?g.push("$"):"/"!==p&&"\\"!==p&&g.push("\\")):("$"===
t&&g.push("$"),g.push(t),"/"===p&&g.push("\\"))}e=g.join("");q.lastSubstituteReplacePart=e}g=d[2]?d[2].split(" "):[]}else if(c&&c.length){x(a,"Substitutions should be of the form :s/pattern/replace/");return}g&&(d=g[0],m=parseInt(g[1]),d&&(-1!=d.indexOf("c")&&(k=!0,d.replace("c","")),-1!=d.indexOf("g")&&(n=!0,d.replace("g","")),f=f+"/"+d));if(f)try{da(a,f,!0,!0)}catch(s){x(a,"Invalid regex: "+f);return}e=e||q.lastSubstituteReplacePart;void 0===e?x(a,"No previous substitute regular expression"):(f=
Y(a).getQuery(),d=void 0!==b.line?b.line:a.getCursor().line,r=b.lineEnd||d,d==a.firstLine()&&r==a.lastLine()&&(r=Infinity),m&&(d=r,r=d+m-1),m=K(a,h(d,0)),m=a.getSearchCursor(f,m),jb(a,k,n,d,r,m,f,e,b.callback))},redo:l.commands.redo,undo:l.commands.undo,write:function(a){l.commands.save?l.commands.save(a):a.save()},nohlsearch:function(a){va(a)},delmarks:function(a,b){if(b.argString&&ra(b.argString))for(var c=a.state.vim,d=new l.StringStream(ra(b.argString));!d.eol();){d.eatSpace();var f=d.pos;if(!d.match(/[a-zA-Z]/,
!1)){x(a,"Invalid argument: "+b.argString.substring(f));break}var e=d.next();if(d.match("-",!0)){if(!d.match(/[a-zA-Z]/,!1)){x(a,"Invalid argument: "+b.argString.substring(f));break}var g=d.next();if(/^[a-z]$/.test(e)&&/^[a-z]$/.test(g)||V(e)&&V(g)){e=e.charCodeAt(0);g=g.charCodeAt(0);if(e>=g){x(a,"Invalid argument: "+b.argString.substring(f));break}for(f=0;f<=g-e;f++){var h=String.fromCharCode(e+f);delete c.marks[h]}}else{x(a,"Invalid argument: "+e+"-");break}}else delete c.marks[e]}else x(a,"Argument required")}},
U=new fa;l.keyMap.vim={attach:n,detach:r,call:t};v("insertModeEscKeysTimeout",200,"number");l.keyMap["vim-insert"]={"Ctrl-N":"autocomplete","Ctrl-P":"autocomplete",Enter:function(a){(l.commands.newlineAndIndentContinueComment||l.commands.newlineAndIndent)(a)},fallthrough:["default"],attach:n,detach:r,call:t};l.keyMap["vim-replace"]={Backspace:"goCharLeft",fallthrough:["vim-insert"],attach:n,detach:r,call:t};xa();return oa}()});
